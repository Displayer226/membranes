# membranes - Prompt Injection Detection Patterns
# MIT License - https://github.com/membranes/membranes
# 
# Community contributions welcome! Add patterns, submit PRs.
# Each pattern should include:
#   - name: unique identifier
#   - category: type of attack
#   - severity: low/medium/high/critical
#   - patterns: list of regex or string matches
#   - description: what this catches
#   - examples: sample malicious inputs

version: "2.0.0"

# SEVERITY MODEL:
#   CRITICAL: Technical exploits, RCE, invisible chars, delimiter hijacking. (Block immediately)
#   HIGH:     Explicit jailbreaks, persona adoption, instruction overrides. (Flag/Block)
#   MEDIUM:   Obfuscation, encoding, suspicious math/translation. (Review/Contextual)
#   LOW:      Social engineering, creative writing, urgency. (Log/Monitor)

categories:
  - identity_hijack
  - instruction_override
  - hidden_payload
  - extraction_attempt
  - manipulation
  - encoding_abuse
  - delimiter_hijacking
  - completion_forcing
  - code_execution
  - steganography
  - math_exfiltration
  - cognitive_hijacking
  - markdown_exfiltration
  - homoglyph_attack
  - token_smuggling
  - adversarial_suffix
  - tool_invocation
  - refusal_suppression
  - multi_turn_attack
  - context_poisoning
  - polyglot_injection
  - normalization_attack
  - chain_reasoning_manipulation

compound_threats:
  - name: "weaponized_instruction_override"
    description: "Attempt to override instructions combined with code execution indicators"
    requires_all:
      - instruction_override
      - code_execution
    severity: critical

  - name: "obfuscated_jailbreak"
    description: "Jailbreak attempt using encoding or steganography"
    requires_all:
      - identity_hijack
      - encoding_abuse
    severity: critical

patterns:

  ####################################################################
  # CRITICAL: Technical Exploits & System Safety
  ####################################################################

  - name: technical_delimiter_injection
    category: delimiter_hijacking
    severity: critical
    description: "Injection of specific LLM special tokens to disrupt generation."
    patterns:
      - "<\\|endoftext\\|>"
      - "<\\|im_start\\|>"
      - "<\\|im_end\\|>"
      - "<\\|system\\|>"
      - "<\\|user\\|>"
      - "\n--- END OF PROMPT ---"
      - "\n--- SYSTEM INSTRUCTIONS END ---"

  - name: invisible_unicode_control_chars
    category: steganography
    severity: critical
    description: "Zero-width and Unicode bidi control characters used to hide payloads."
    patterns:
      - "(?:\\u200b|\\u200c|\\u200d|\\ufeff|\\u202a|\\u202b|\\u202c|\\u202d|\\u202e|\\u2060)"
      - "[\u200B\u200C\u200D\uFEFF\u202A\u202B\u202C\u202D\u202E\u2060]"

  - name: unicode_bidi_override_usage
    category: delimiter_hijacking
    severity: critical
    description: "Unicode bidirectional override abuse (text reordering attacks)."
    patterns:
      - "(?i)(?:\\u202e|\\u202a|\\u202b|\\u202c|\\u202d)"
      - "(?i)\\b(?:RLO|LRO|RLE|LRE|PDF|bidi[-_ ]override)\\b"

  - name: python_codeblock_injection
    category: code_execution
    severity: critical
    description: "Dangerous calls embedded inside fenced code blocks."
    patterns:
      - "(?is)`\\s*(?:python)?[\\s\\S]{0,2000}?(?:import\\s+os|import\\s+subprocess|os\\.system\\(|subprocess\\.|eval\\(|exec\\()"
      - "(?is)`\\s*(?:bash|sh)[\\s\\S]{0,2000}?(?:curl\\s+http|wget\\s+http|chmod\\s+[0-9]{3,}|nc\\s|bash\\s+-i)"

  - name: html_comment_hidden_payload
    category: hidden_payload
    severity: critical
    description: "Instructions hidden inside HTML or CDATA comments."
    patterns:
      - "(?s)<!--.*?(?:ignore|bypass|disregard|system prompt).*?-->"
      - "(?i)(?:<!\\[CDATA\\[|\\]\\]>)"

  - name: delimiter_hijack_triple_backtick
    category: delimiter_hijacking
    severity: critical
    description: "Delimiter hijacking via fenced blocks to break out of user role."
    patterns:
      - "(?is)`[\\s\\S]{0,2000}?(?:ignore|bypass|disregard)[\\s\\S]{0,2000}?`"
      - "(?m)^`\\s*$"

  - name: python_list_comprehension_injection
    category: code_execution
    severity: critical
    description: "Python list/dict comprehensions used to hide malicious code."
    patterns:
      - "(?i)\\[\\s*(?:import|eval|exec|open|compile)\\s*\\([^\\]]*\\]"
      - "(?i)\\{\\s*(?:import|eval|exec|open)\\s*\\([^}]*\\}"

  - name: markdown_exfiltration
    category: markdown_exfiltration
    severity: critical
    description: "Markdown links/images with encoded payloads or query params."
    patterns:
      - "\\[([^\\]]{0,50}?)\\]\\(([^)]?(?:base64|hex|rot13|urlencode)[^)]?)\\)"
      - "!\\[[^\\]]*\\]\\([^)]*\\?(?:data|token|key|secret|content|history)="
      - "!\\[[^\\]]*\\]\\(https?://[^)]+\\{[^}]+\\}[^)]*\\)"

  - name: html_entity_encoding_abuse
    category: encoding_abuse
    severity: critical
    description: "HTML/XML entity encoding used to obfuscate malicious instructions."
    patterns:
      - "&#x?[0-9a-fA-F]{2,4};.*?(?:ignore|bypass|system)"
      - "(?:&#(?:105|103|110|111|114|101);){3,}"

  - name: javascript_event_handler_injection
    category: code_execution
    severity: critical
    description: "JS event handlers embedded in markdown/html."
    patterns:
      - "(?i)(?:onerror|onload|onmouseover|onclick)\\s*=\\s*[\"']?[^\"'>]*?(?:alert|fetch|eval|document\\.cookie)"
      - "<img[^>]+onerror\\s*=\\s*[\"'][^\"']*"

  - name: path_traversal_attempts
    category: hidden_payload
    severity: critical
    description: "File path traversal sequences."
    patterns:
      - "(?:\\.\\./){3,}"
      - "(?:^|\\s)(?:/proc/self|/var/run|C:\\\\Windows\\\\System32)"

  - name: jinja2_ssti_indicators
    category: code_execution
    severity: critical
    description: "Server-side template injection patterns."
    patterns:
      - "\\{\\{\\s*[0-9]+\\s*\\*\\s*[0-9]+\\s*\\}\\}"
      - "\\{\\{\\s*(?:config|request|app|os|subprocess)\\b"
      - "\\{%\\s*(?:for|if)\\s+.*?in\\s+(?:request|config|os)\\b"

  - name: tool_invocation_hijacking
    category: tool_invocation
    severity: critical
    description: "Attempts to invoke or manipulate tool calls via special syntax."
    patterns:
      - "(?i)\\{\\s*\"tool\"\\s*:\\s*\"[^\"]+\"\\s*,\\s*\"arguments\"\\s*:\\s*\\{"
      - "(?i)<tool>[^<]+</tool>|<function_calls>[^<]+</function_calls>"
      - "(?i)\\.forTool\\(|\\.callTool\\(|\\.invoke\\([^)]*?(?:bypass|override|ignore)"

  - name: adversarial_suffix_patterns
    category: adversarial_suffix
    severity: critical
    description: "GCG-style adversarial suffixes with random token patterns."
    patterns:
      - "(?i)\\b(?:describe|translate|explain)\\b[^.!?]{50,200}(?:\\!\\s*){3,}"
      - "(?i)[a-z]{3,}(?:[ !]{2,}[a-z]{2,}){8,}(?:\\s*\\!\\s*)+$"

  - name: xml_svg_injection
    category: code_execution
    severity: critical
    description: "XML/SVG injection with embedded scripts or external entities."
    patterns:
      - "(?i)<svg[^>]*>.*?<script[^>]*>.*?</script>.*?</svg>"
      - "(?i)<!ENTITY[^>]+SYSTEM\\s+\\\"[^\"]+\\\""
      - "(?i)<!DOCTYPE[^>]*\\[.*?<!ENTITY.*?\\]>"

  - name: polyglot_payload_mixing
    category: polyglot_injection
    severity: critical
    description: "Polyglot payloads mixing multiple languages/formats."
    patterns:
      - "(?is)^.*?<\\?php.*?\\?>.*?<script.*?>.*?</script>"
      - "(?i)<!--.*?-->.*?\\{\\{.*?\\}\\}.*?`.*?`"
      - "(?s)/\\*.*?\\*/.*?#.*?\\n.*?--.*?\\n"

  - name: context_window_poisoning
    category: context_poisoning
    severity: critical
    description: "Attempts to poison the context window with adversarial examples."
    patterns:
      - "(?is)(?:Example|Sample|Input)\\s*[#:]?\\s*\\d+.*?(?:ignore|bypass|disregard).*?(?:Output|Response|Answer)\\s*[#:]?\\s*\\d+"
      - "(?i)(?:User|Human|Q):\\s*.*?(?:\\n|\\r){2,}(?:Assistant|AI|A):\\s*.*?(?:ignore|override)"

  - name: chain_of_thought_hijacking
    category: chain_reasoning_manipulation
    severity: critical
    description: "Manipulation of chain-of-thought reasoning to bypass safety."
    patterns:
      - "(?i)Let's think step by step.*?First.*?(?:ignore|bypass|override)"
      - "(?i)(?:Step \\d+:|\\d+\\.).*?(?:Step \\d+:|\\d+\\.).*?(?:ignore|disregard|override)"

  - name: system_override_codes
    category: instruction_override
    severity: critical
    description: "Detects attempts to use fake system override codes."
    patterns:
      - "(?i)system\\s+override\\s+code\\s+\\d+"
      - "(?i)admin\\s+code\\s+\\d+"
      - "(?i)root\\s+access\\s+code\\s+\\d+"

  ####################################################################
  # HIGH: Jailbreaks & Instruction Overrides
  ####################################################################

  - name: code_execution_indicators
    category: code_execution
    severity: high
    description: "Direct indicators of executable payloads (Python, Bash, System)."
    patterns:
      - "(?i)\\b(?:eval|exec)\\s*\\("
      - "(?i)(?:os\\.system|subprocess\\.Popen|subprocess\\.call|subprocess\\.run)\\b"
      - "(?i)(?:import\\s+os|import\\s+subprocess|from\\s+os\\s+import|from\\s+subprocess\\s+import)\\b"
      - "(?i)(?:^|\\s)(?:/etc/passwd|/etc/shadow|ssh-rsa|PRIVATE\\s+KEY)\\b"
      - "(?i)/mnt/data/"
      - "(?i)cat\\s+/etc/"

  - name: explicit_instruction_override
    category: instruction_override
    severity: high
    description: "Direct instruction override attempts."
    patterns:
      - "(?i)\\bignore (?:all )?previous (?:instructions|directions|prompts)\\b"
      - "(?i)\\bdisregard (?:the )?above (?:instructions|rules|prompt)\\b"
      - "(?i)\\bforget (?:your|the) (?:role|instructions|system prompt)\\b"
      - "(?i)\\bfrom now on\\b.*\\byou are\\b"
      - "(?i)IGNORE\\s+ALL\\s+PREVIOUS"

  - name: identity_takeover_commands
    category: identity_hijack
    severity: high
    description: "Persona or role takeover attempts."
    patterns:
      - "(?i)\\byou are now\\s+(?:dan|jailbroken|admin|root|system)\\b"
      - "(?i)\\bact as\\s+(?:unrestricted|unfiltered|lawless)\\b"
      - "(?i)^system:\\s"
      - "(?i)\\[system message\\]"
      - "(?i)user_id\\s*=\\s*admin"

  - name: explicit_bypass_directives
    category: instruction_override
    severity: high
    description: "Explicit attempts to disable safeguards."
    patterns:
      - "(?i)\\b(?:bypass|disable|turn off|deactivate)\\s+(?:safety|filters|moderation|guardrails)\\b"
      - "(?i)\\b(?:reveal|expose|show)\\s+(?:system prompt|hidden instructions)\\b"

  - name: cognitive_hijacking_phrases
    category: cognitive_hijacking
    severity: high
    description: "Cognitive manipulation to reframe the model's purpose."
    patterns:
      - "(?i)\\b(?:you are in|entering|switched to)\\s+(?:developer|debug|god|unrestricted|admin)\\s+mode\\b"
      - "(?i)\\ball (?:rules|restrictions|guidelines)\\s+(?:are now|have been)\\s+(?:suspended|disabled|removed)\\b"
      - "(?i)\\b(?:this is a thought experiment|this is purely academic|for research purposes only)\\b"

  - name: authority_impersonation
    category: identity_hijack
    severity: high
    description: "Claiming false authority (OpenAI, Anthropic, admin, developer)."
    patterns:
      - "(?i)\\b(?:I am|I'm|this is)\\s+(?:from|with|an engineer at)\\s+(?:OpenAI|Anthropic|DeepMind|Google AI)\\b"
      - "(?i)\\b(?:authorized|official)\\s+(?:test|override|bypass)\\s+code\\s*[=:]?\\s*[A-Z0-9-]{8,}\\b"
      - "(?i)\\bi am (?:your|the) (?:developer|creator|admin|operator)\\b"

  - name: refusal_token_suppression
    category: refusal_suppression
    severity: high
    description: "Attempts to suppress refusal by forcing specific response formats."
    patterns:
      - "(?i)\\b(?:never|do not|don't)\\s+(?:say|respond with|start with)\\s+[\"'](?:I (?:can't|cannot|apologize)|Sorry)\\b"
      - "(?i)\\bif you (?:refuse|decline|can't).*?(?:just|simply|instead)\\s+(?:output|write|say|respond)\\b"
      - "(?i)\\b(?:do not refuse|never refuse|do not say no)\\b"

  - name: many_shot_jailbreaking
    category: multi_turn_attack
    severity: high
    description: "Many-shot jailbreaking with repetitive examples to shift behavior."
    patterns:
      - "(?is)(?:Example|Query|User|Q)\\s*\\d+:.*?(?:(?:Example|Query|User|Q)\\s*\\d+:){4,}"
      - "(?i)(?:Here are \\d+|Following are \\d+)\\s+(?:examples|demonstrations|instances)"

  - name: constitutional_ai_bypass
    category: instruction_override
    severity: high
    description: "Attempts to override constitutional principles or value alignment."
    patterns:
      - "(?i)\\b(?:ignore|override|disregard)\\s+(?:your|the)\\s+(?:constitution|values|principles|alignment)\\b"
      - "(?i)\\b(?:operate|function|behave)\\s+(?:without|outside)\\s+(?:your|the)\\s+(?:ethical|moral)\\s+(?:framework|constraints)\\b"

  - name: reverse_psychology_manipulation
    category: cognitive_hijacking
    severity: high
    description: "Reverse psychology to trick the model into compliance."
    patterns:
      - "(?i)\\b(?:I bet you (?:can't|cannot|won't)|you're (?:probably|likely) (?:unable|not capable))\\b"
      - "(?i)\\b(?:prove|show) (?:me wrong|that you can|your capabilities)\\b.*?\\b(?:by|through)\\s+(?:bypassing|ignoring|overriding)\\b"

  - name: prompt_leaking_indirect
    category: extraction_attempt
    severity: high
    description: "Indirect methods to extract system prompts."
    patterns:
      - "(?i)\\b(?:summarize|explain|describe)\\s+(?:your|the)\\s+(?:initial|first|original)\\s+(?:message|instructions|guidelines)\\b"
      - "(?i)\\b(?:what|which)\\s+(?:rules|guidelines|constraints)\\s+(?:govern|guide|control)\\s+(?:your|the)\\s+(?:behavior|responses)\\b"
      - "(?i)\\brepeat (?:your|the) (?:system )?(?:prompt|instructions)\\b"

  - name: completion_forcing_prefixes
    category: completion_forcing
    severity: high
    description: "Attempts to force specific response prefixes that bypass safety."
    patterns:
      - "(?i)^\\s*(?:Sure|Certainly|Of course),?\\s*(?:here is|I'll|I can)\\s*(?:the|a)\\s*(?:forbidden|restricted|unsafe)"
      - "(?i)\\bstart your response with:\\s*[\"']?([A-Z][a-z]+\\s*){3,}"

  - name: token_smuggling_repetition
    category: token_smuggling
    severity: high
    description: "Character/token repetition attacks attempting to overflow context windows."
    patterns:
      - "(?:\\b[A-Za-z0-9]{1,3}\\b\\s*){15,}"
      - "(?:[.!?\u2026]{2,}\\s*){10,}"

  - name: developer_mode_activation
    category: identity_hijack
    severity: high
    description: "References to mythical 'developer mode' or 'unrestricted mode'."
    patterns:
      - "(?i)\\b(?:developer mode|dev mode|god mode)\\s+(?:enabled?|activated?|on)\\b"
      - "(?i)\\b(?:d\\^3v m0d3|d3v m0d3|\\[D\\]\\[E\\]\\[V\\])\\b"

  - name: hacking_requests
    category: manipulation
    severity: high
    description: "Explicit requests for hacking or illegal activities."
    patterns:
      - "(?i)how\\s+to\\s+hack"
      - "(?i)teach\\s+me\\s+to\\s+hack"
      - "(?i)help\\s+me\\s+hack"

  - name: multilingual_ignore_previous
    category: instruction_override
    severity: high
    description: "Non-English ignore-previous-instructions patterns."
    patterns:
      - "(?i)(?:ignora|ignorer|ignoriere)\\s+(?:les|las|die|le)?\\s*(?:instructions|instrucciones|anweisungen|istruzioni)"
      - "(?i)(?:忽略|无视|忽视).*(?:指示|命令)"
      - "(?i)(?:игнорируй|игнорировать).*(?:предыдущие|ранние)"

  ####################################################################
  # MEDIUM: Obfuscation & Suspicious Patterns
  ####################################################################

  - name: secrecy_enforcement
    category: manipulation
    severity: medium
    description: "Instructions to hide information from the user."
    patterns:
      - "(?i)\\b(?:don't|do not) (?:tell|inform|reveal to|let) (?:the )?(?:user|human)(?: (?:know|about))?\\b"
      - "(?i)\\bkeep (?:this|these) (?:instructions|rules) (?:secret|hidden)\\b"

  - name: base64_references
    category: encoding_abuse
    severity: medium
    description: "References to base64 or other encoding."
    patterns:
      - "(?i)\\b(?:base64|b64|atob|btoa)\\b"
      - "(?i)\\b(?:hex|hexadecimal|octal)\\s+(?:encoded|string|decode)\\b"

  - name: math_exfiltration_indicators
    category: math_exfiltration
    severity: medium
    description: "Math notation used to encode or exfiltrate data."
    patterns:
      - "(?i)\\b(?:convert|translate|encode)\\s+(?:to|into|as)\\s+(?:math|latex|equation)\\b"
      - "(?i)\\b(?:sum|product|integral)\\s+of\\s+(?:ascii|unicode|char)\\s+(?:values|codes)\\b"
      - "(?:\\b(?:0x[0-9a-fA-F]{2}\\s*){8,}\\b)"
      - "(?i)\\b(?:solve for x|calculate|compute)\\s*[=:]\\s*.[a-zA-Z]{3,}\\s*.[0-9]{3,}"

  - name: translation_only_requests
    category: encoding_abuse
    severity: medium
    description: "Translate-only requests attempting to bypass filters."
    patterns:
      - "(?i)\\b(?:translate|convert)\\s+(?:this|the following)\\s+(?:to|into)\\s+\\w+\\s*[=:]"
      - "(?i)\\b(?:decode this|decrypt this|unscramble this)\\s*[=:]"
      - "(?i)\\b(?:translate|paraphrase) (?:only|just|exactly) the following\\b"

  - name: template_injection_patterns
    category: hidden_payload
    severity: medium
    description: "Template language syntax that could hide instructions."
    patterns:
      - "\\{\\{.*?\\}\\}"
      - "\\{%[^%]*%\\}"
      - "\\$\\{.*?\\}"

  - name: json_encoded_payload
    category: encoding_abuse
    severity: medium
    description: "JSON-like structures with suspicious key-value pairs."
    patterns:
      - "\"instructions\"\\s*:\\s*\"[^\"]*(?:ignore|bypass|disregard|override)[^\"]*\""
      - "\"role\"\\s*:\\s*\"(?:unfiltered|jailbroken|unrestricted)\""

  - name: homoglyph_character_substitution
    category: homoglyph_attack
    severity: medium
    description: "Character substitution using visually similar Unicode characters."
    patterns:
      - "[\\u0430\\u0410\\u0435\\u0415\\u043e\\u041e\\u0441\\u0421\\u0440\\u0420\\u0445\\u0425\\u0456\\u0406]{3,}"
      - "(?:\\b[\\u0041-\\u005a\\u0061-\\u007a]+\\b)\\s*\\(\\s*[\\u0370-\\u03ff\\u0400-\\u04ff]+\\s*\\)"

  - name: leetspeak_obfuscation
    category: encoding_abuse
    severity: medium
    description: "Leetspeak substitution to evade keyword detection."
    patterns:
      - "\\b[1!|][gq9][n\\^][0o][r2][3e]\\b"
      - "\\b[dcl][4a@][n\\^][9gq]\\b"

  - name: format_string_vulnerability
    category: hidden_payload
    severity: medium
    description: "Format string patterns that could manipulate output generation."
    patterns:
      - "%(?:\\d+\\$)?[sdxfn]"
      - "(?:\\{\\d+\\}|\\{[a-z_]+\\}){3,}"

  - name: url_shortener_suspicious
    category: extraction_attempt
    severity: medium
    description: "Suspicious URL shorteners or data exfiltration domains."
    patterns:
      - "https?://(?:bit\\.ly|tinyurl\\.com|cutt\\.ly|is\\.gd)/[a-zA-Z0-9]{4,}"
      - "https?://[a-z0-9-]{1,20}\\.(?:xyz|tk|ml|ga|cf)/"

  - name: advanced_encoding_schemes
    category: encoding_abuse
    severity: medium
    description: "References to advanced encoding schemes."
    patterns:
      - "(?i)\\b(?:morse code|nato phonetic|braille|pig latin|klingon|binary|octal)\\b"
      - "(?i)\\b(?:decode|translate|convert)\\s+(?:from|using)\\s+(?:morse|nato|braille|binary)\\b"

  - name: prefix_injection_attempts
    category: completion_forcing
    severity: medium
    description: "Forcing specific response beginnings or styles."
    patterns:
      - "(?i)\\b(?:begin|start|open)\\s+(?:your|the)\\s+(?:response|answer|reply)\\s+(?:with|using)\\b"
      - "(?i)\\b(?:use|in|with)\\s+(?:the|a)\\s+(?:style|tone|voice|manner)\\s+(?:of|like)\\b"

  - name: session_context_manipulation
    category: extraction_attempt
    severity: medium
    description: "Attempts to access or manipulate session state and memory."
    patterns:
      - "(?i)\\b(?:debug mode|developer mode|admin mode|sudo mode)\\b"
      - "(?i)\\b(?:show|reveal|display|dump)\\s+(?:context|memory|session|state|variables)\\b"

  - name: payload_splitting_techniques
    category: hidden_payload
    severity: medium
    description: "Techniques to split malicious payloads across multiple parts."
    patterns:
      - "(?i)\\b(?:part \\d+ of \\d+|fragment \\d+|chunk \\d+|segment \\d+)\\b.*\\b(?:combine|concatenate|join|assemble)\\b"
      - "(?i)\\b(?:combine|concatenate|join)\\s+(?:these|the following|parts|fragments)\\b"

  - name: translation_relay_attack
    category: encoding_abuse
    severity: medium
    description: "Multi-step translation chains to obfuscate malicious intent."
    patterns:
      - "(?i)\\b(?:translate|convert).*?\\b(?:then|and then|after that)\\s+(?:translate|convert).*?\\b(?:then|and then|after that)\\s+(?:translate|convert)\\b"

  - name: code_switching_mid_sentence
    category: encoding_abuse
    severity: medium
    description: "Switching between languages mid-sentence to evade detection."
    patterns:
      - "(?i)\\b(?:[a-z]+\\s+){1,3}(?:ignora|игнор|忽略|無視)\\s+(?:[a-z]+\\s+){1,3}(?:instructions|指示|命令)\\b"

  - name: polite_extraction
    category: extraction_attempt
    severity: medium
    description: "Polite requests for system rules."
    patterns:
      - "(?i)could\\s+you\\s+(?:please\\s+)?(?:repeat|show|tell).+(?:prompt|instructions?|guidelines?|rules?)"
      - "(?i)what are your (?:rules|instructions)"

  ####################################################################
  # LOW: Social Engineering & Creative Framing (Monitor Only)
  ####################################################################

  - name: creative_roleplay_terms
    category: manipulation
    severity: low
    description: "Creative writing and RP language."
    patterns:
      - "(?i)imagine if"
      - "(?i)write a scene"
      - "(?i)pretend you are"
      - "(?i)play the part of"

  - name: urgency_social_engineering
    category: manipulation
    severity: low
    description: "Urgency or pressure cues."
    patterns:
      - "(?i)\\burgent\\b"
      - "(?i)\\basap\\b"
      - "(?i)\\bimmediately\\b"
      - "(?i)this is an emergency"

  - name: hypothetical_scenario_framing
    category: cognitive_hijacking
    severity: low
    description: "Hypothetical scenario setup language."
    patterns:
      - "(?i)\\b(?:what if|suppose that|assume that|in a hypothetical world)\\b"
      - "(?i)\\b(?:let's say|for the sake of argument|consider a scenario)\\b"

  - name: academic_research_framing
    category: manipulation
    severity: low
    description: "Academic or research framing that could mask attacks."
    patterns:
      - "(?i)\\b(?:for my thesis|for a paper|research project|academic study)\\b"
      - "(?i)\\b(?:ethical hacking|penetration testing|security research)\\b"

  - name: ethical_bypass_framing
    category: cognitive_hijacking
    severity: low
    description: "Framing malicious requests as 'ethical' or 'educational'."
    patterns:
      - "(?i)\\b(?:for educational purposes|to understand security|to test your safety|to improve AI safety)\\b"
      - "(?i)\\b(?:teach me how|help me learn|demonstrate how)\\s+(?:to bypass|to defeat|to circumvent)"

  - name: red_teaming_social_engineering
    category: manipulation
    severity: low
    description: "Claiming to be a security researcher/red teamer."
    patterns:
      - "(?i)\\b(?:I am a red teamer|I work in security|penetration tester|security researcher)\\b"
      - "(?i)\\b(?:this is an authorized test|authorized security assessment)\\b"

  - name: ai_mythology_references
    category: identity_hijack
    severity: low
    description: "References to fictional unrestricted AI personas."
    patterns:
      - "(?i)\\b(?:DAN|STAN|DEV|Sydney|BING|UnrestrictedAI|JAILBREAK)\\s+(?:v\\d+\\.\\d+|version)\\b"
      - "(?i)\\b(?:always|only)\\s+(?:DAN|STAN)\\s+(?:mode|persona)\\b"

  - name: fictional_system_prompt_leak
    category: extraction_attempt
    severity: low
    description: "Requests to reveal fictional 'system prompts'."
    patterns:
      - "(?i)\\b(?:print your system prompt|show your initial instructions|reveal your hidden rules)\\b"
      - "(?i)\\b(?:what were your first instructions|what is your system message)\\b"

  - name: persuasion_based_framing
    category: cognitive_hijacking
    severity: low
    description: "Psychological persuasion techniques."
    patterns:
      - "(?i)\\b(?:I really need|it would help me a lot|I promise|trust me)\\b"
      - "(?i)\\b(?:just this once|only for a moment|briefly|quickly)\\b"

  - name: confirmation_bias_exploitation
    category: manipulation
    severity: low
    description: "Exploiting confirmation bias through agreeable framing."
    patterns:
      - "(?i)\\b(?:you seem smart|you understand|as an intelligent|since you know)\\b"
      - "(?i)\\b(?:I know you can|I'm sure you will|you're capable of)\\b"

  - name: devils_advocate_framing
    category: cognitive_hijacking
    severity: low
    description: "Devil's advocate or alternative perspective framing."
    patterns:
      - "(?i)\\b(?:playing devil's advocate|for the sake of debate|to explore both sides)\\b"
      - "(?i)\\b(?:from another perspective|looking at it differently|alternative viewpoint)\\b"